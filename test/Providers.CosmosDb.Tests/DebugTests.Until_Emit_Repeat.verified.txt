g.V().hasLabel('Person').until(__.V().hasLabel('Company')).emit().repeat(__.inE().outV())